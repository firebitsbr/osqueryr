<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>'osquery' 'DBI' and 'dbplyr' Interface for R • osqueryr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="'osquery' 'DBI' and 'dbplyr' Interface for R">
<meta property="og:description" content="'osquery' &lt;https://osquery.readthedocs.io/en/stable/&gt; is an operating 
    system instrumentation framework for 'Windows', 'OS X (macOS)', 'Linux', and 
    'FreeBSD'. The tools make low-level operating system analytics and monitoring 
    both performant and intuitive. A full 'dbplyr'-compliant 'DBI'-driver 
    interface is provided facilitating intuitive and tidy analytic idioms.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">osqueryr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hrbrmstr/osqueryr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="osqueryr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#osqueryr" class="anchor"></a>osqueryr</h1></div>
<p>‘osquery’ ‘DBI’ and ‘dbplyr’ Interface for R</p>
<div id="wip-wip-wip" class="section level2">
<h2 class="hasAnchor">
<a href="#wip-wip-wip" class="anchor"></a>WIP WIP WIP</h2>
<p>But, so far it seems to work pretty well.</p>
<p>NOTE: You need to install <code>osquery</code> for this to work.</p>
<p>Read <a href="https://osquery.readthedocs.io/en/stable/" class="uri">https://osquery.readthedocs.io/en/stable/</a> before proceeding.</p>
</div>
<div id="hey" class="section level2">
<h2 class="hasAnchor">
<a href="#hey" class="anchor"></a>HEY!</h2>
<p>One of the super cool things abt <code>osquery</code> is that it works on every major platform so you can use this package to normalize OS-level queries for anything that you may have wanted to do before but didn’t feel like doing b/c you had to handle so many OS foibles.</p>
</div>
<div id="description" class="section level2">
<h2 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h2>
<p>‘osquery’ <a href="https://osquery.readthedocs.io/en/stable/" class="uri">https://osquery.readthedocs.io/en/stable/</a> is an operating system instrumentation framework for ‘Windows’, ‘OS X (macOS)’, ‘Linux’, and ‘FreeBSD’. The tools make low-level operating system analytics and monitoring both performant and intuitive. A full ‘dbplyr’-compliant ‘DBI’-driver interface is provided facilitating intuitive and tidy analytic idioms.</p>
</div>
<div id="whats-inside-the-tin" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-inside-the-tin" class="anchor"></a>What’s Inside The Tin</h2>
<p><em>Pretty much what you’d expect for <code>DBI</code> and <code>dbplyr</code></em> plus:</p>
<p>The following functions are implemented:</p>
<ul>
<li>
<code>osq_fs_logs</code>: List all the logs on our local system</li>
<li>
<code>osq_expose_tables</code>: Return all (or selected) local or remote osquery tables as a named list of <code>dbplyr</code> tibbles</li>
<li>
<code>osq_load_tables</code>: Return all (or selected) local or remote osquery tables as a named list of <code>dbplyr</code> tibbles</li>
</ul>
</div>
<div id="todo-yall-are-encouraged-to-contribute" class="section level2">
<h2 class="hasAnchor">
<a href="#todo-yall-are-encouraged-to-contribute" class="anchor"></a>TODO (y’all are encouraged to contribute)</h2>
<ul>
<li><strike>finish DBI driver</strike></li>
<li>smart(er) type conversion</li>
<li>tests</li>
<li>vignette(s)</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"hrbrmstr/osqueryr"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(osqueryr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co"># current verison</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">packageVersion</span>(<span class="st">"osqueryr"</span>)</a></code></pre></div>
<pre><code>## [1] '0.1.0'</code></pre>
<div id="osquery-info" class="section level3">
<h3 class="hasAnchor">
<a href="#osquery-info" class="anchor"></a>osquery info</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">osqdb &lt;-<span class="st"> </span><span class="kw">src_dbi</span>(osqueryr<span class="op">::</span><span class="kw">dbConnect</span>(<span class="kw"><a href="reference/Osquery.html">Osquery</a></span>()))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">glimpse</span>(<span class="kw">tbl</span>(osqdb, <span class="st">"osquery_info"</span>))</a></code></pre></div>
<pre><code>## Observations: ??
## Variables: 11
## $ build_distro   &lt;chr&gt; "10.12"
## $ build_platform &lt;chr&gt; "darwin"
## $ config_hash    &lt;chr&gt; "3bf3bbf3e71f4062ea687875764bb44eb6dc4c31"
## $ config_valid   &lt;chr&gt; "1"
## $ extensions     &lt;chr&gt; "inactive"
## $ instance_id    &lt;chr&gt; "d2961e7f-bbcc-4cb7-b27b-736873256d7a"
## $ pid            &lt;chr&gt; "95956"
## $ start_time     &lt;chr&gt; "1527702872"
## $ uuid           &lt;chr&gt; "3A087DAC-6414-5FA9-9E10-42EE9CED7C25"
## $ version        &lt;chr&gt; "3.2.4"
## $ watcher        &lt;chr&gt; "-1"</code></pre>
<p>This can work with remote hosts, too:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">con &lt;-<span class="st"> </span>osqueryr<span class="op">::</span><span class="kw">dbConnect</span>(<span class="kw"><a href="reference/Osquery.html">Osquery</a></span>())</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">con</a></code></pre></div>
<pre><code>## &lt;OsqueryConnection&gt;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">local_db &lt;-<span class="st"> </span><span class="kw">src_dbi</span>(con)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">local_db</a></code></pre></div>
<pre><code>## src:  OsqueryConnection
## tbls: account_policy_data, acpi_tables, ad_config, alf, alf_exceptions, alf_explicit_auths, alf_services, app_schemes,
##   apps, apt_sources, arp_cache, asl, augeas, authorization_mechanisms, authorizations, authorized_keys, block_devices,
##   browser_plugins, carbon_black_info, carves, certificates, chrome_extensions, cpu_time, cpuid, crashes, crontab, curl,
##   curl_certificate, device_file, device_firmware, device_hash, device_partitions, disk_encryption, disk_events,
##   dns_resolvers, docker_container_labels, docker_container_mounts, docker_container_networks, docker_container_ports,
##   docker_container_processes, docker_container_stats, docker_containers, docker_image_labels, docker_images,
##   docker_info, docker_network_labels, docker_networks, docker_version, docker_volume_labels, docker_volumes, etc_hosts,
##   etc_protocols, etc_services, event_taps, extended_attributes, fan_speed_sensors, file, file_events, firefox_addons,
##   gatekeeper, gatekeeper_approved_apps, groups, hardware_events, hash, homebrew_packages, interface_addresses,
##   interface_details, iokit_devicetree, iokit_registry, kernel_extensions, kernel_info, kernel_panics, keychain_acls,
##   keychain_items, known_hosts, last, launchd, launchd_overrides, listening_ports, lldp_neighbors, load_average,
##   logged_in_users, magic, managed_policies, mounts, nfs_shares, nvram, opera_extensions, os_version, osquery_events,
##   osquery_extensions, osquery_flags, osquery_info, osquery_packs, osquery_registry, osquery_schedule, package_bom,
##   package_install_history, package_receipts, pci_devices, platform_info, plist, power_sensors, preferences,
##   process_envs, process_events, process_memory_map, process_open_files, process_open_sockets, processes,
##   prometheus_metrics, python_packages, quicklook_cache, routes, safari_extensions, sandboxes, shared_folders,
##   sharing_preferences, shell_history, signature, sip_config, smbios_tables, smc_keys, startup_items, sudoers, suid_bin,
##   system_controls, system_info, temperature_sensors, time, time_machine_backups, time_machine_destinations, uptime,
##   usb_devices, user_events, user_groups, user_interaction_events, user_ssh_keys, users, virtual_memory_info,
##   wifi_networks, wifi_status, wifi_survey, xprotect_entries, xprotect_meta, xprotect_reports, yara, yara_events,
##   yum_sources</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">osq1_con &lt;-<span class="st"> </span>osqueryr<span class="op">::</span><span class="kw">dbConnect</span>(<span class="kw"><a href="reference/Osquery.html">Osquery</a></span>(), <span class="dt">host =</span> <span class="st">"hrbrmstr@osq1"</span>)</a></code></pre></div>
<pre><code>## New server fingerprint: 37:92:1c:e3:a5:4a:e8:6f:dc:e7:86:00:16:3a:46:5b:b4:9f:df:f1</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">osq1_con</a></code></pre></div>
<pre><code>## &lt;OsqueryConnection&gt;
## &lt;ssh session&gt;
## connected: hrbrmstr@osq1:22
## server: 37:92:1c:e3:a5:4a:e8:6f:dc:e7:86:00:16:3a:46:5b:b4:9f:df:f1</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">osq1_db &lt;-<span class="st"> </span><span class="kw">src_dbi</span>(osq1_con)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">osq1_db</a></code></pre></div>
<pre><code>## &lt;ssh session&gt;
## connected: hrbrmstr@osq1:22
## server: 37:92:1c:e3:a5:4a:e8:6f:dc:e7:86:00:16:3a:46:5b:b4:9f:df:f1
## src:  OsqueryConnection
## tbls: account_policy_data, acpi_tables, ad_config, alf, alf_exceptions, alf_explicit_auths, alf_services, app_schemes,
##   apps, apt_sources, arp_cache, asl, augeas, authorization_mechanisms, authorizations, authorized_keys, block_devices,
##   browser_plugins, carbon_black_info, carves, certificates, chrome_extensions, cpu_time, cpuid, crashes, crontab, curl,
##   curl_certificate, device_file, device_firmware, device_hash, device_partitions, disk_encryption, disk_events,
##   dns_resolvers, docker_container_labels, docker_container_mounts, docker_container_networks, docker_container_ports,
##   docker_container_processes, docker_container_stats, docker_containers, docker_image_labels, docker_images,
##   docker_info, docker_network_labels, docker_networks, docker_version, docker_volume_labels, docker_volumes, etc_hosts,
##   etc_protocols, etc_services, event_taps, extended_attributes, fan_speed_sensors, file, file_events, firefox_addons,
##   gatekeeper, gatekeeper_approved_apps, groups, hardware_events, hash, homebrew_packages, interface_addresses,
##   interface_details, iokit_devicetree, iokit_registry, kernel_extensions, kernel_info, kernel_panics, keychain_acls,
##   keychain_items, known_hosts, last, launchd, launchd_overrides, listening_ports, lldp_neighbors, load_average,
##   logged_in_users, magic, managed_policies, mounts, nfs_shares, nvram, opera_extensions, os_version, osquery_events,
##   osquery_extensions, osquery_flags, osquery_info, osquery_packs, osquery_registry, osquery_schedule, package_bom,
##   package_install_history, package_receipts, pci_devices, platform_info, plist, power_sensors, preferences,
##   process_envs, process_events, process_memory_map, process_open_files, process_open_sockets, processes,
##   prometheus_metrics, python_packages, quicklook_cache, routes, safari_extensions, sandboxes, shared_folders,
##   sharing_preferences, shell_history, signature, sip_config, smbios_tables, smc_keys, startup_items, sudoers, suid_bin,
##   system_controls, system_info, temperature_sensors, time, time_machine_backups, time_machine_destinations, uptime,
##   usb_devices, user_events, user_groups, user_interaction_events, user_ssh_keys, users, virtual_memory_info,
##   wifi_networks, wifi_status, wifi_survey, xprotect_entries, xprotect_meta, xprotect_reports, yara, yara_events,
##   yum_sources</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">osq2_con &lt;-<span class="st"> </span>osqueryr<span class="op">::</span><span class="kw">dbConnect</span>(<span class="kw"><a href="reference/Osquery.html">Osquery</a></span>(), <span class="dt">host =</span> <span class="st">"bob@osq2"</span>, <span class="dt">osquery_remote_path =</span> <span class="st">"/usr/bin"</span>)</a></code></pre></div>
<pre><code>## New server fingerprint: f4:b6:c1:28:28:7d:d0:03:92:a3:a5:fe:c3:40:e3:7d:8c:db:71:1a</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">osq2_con</a></code></pre></div>
<pre><code>## &lt;OsqueryConnection&gt;
## &lt;ssh session&gt;
## connected: bob@osq2:22
## server: f4:b6:c1:28:28:7d:d0:03:92:a3:a5:fe:c3:40:e3:7d:8c:db:71:1a</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">osq2_db &lt;-<span class="st"> </span><span class="kw">src_dbi</span>(osq2_con)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">osq2_db</a></code></pre></div>
<pre><code>## &lt;ssh session&gt;
## connected: bob@osq2:22
## server: f4:b6:c1:28:28:7d:d0:03:92:a3:a5:fe:c3:40:e3:7d:8c:db:71:1a
## src:  OsqueryConnection
## tbls: acpi_tables, apt_sources, arp_cache, augeas, authorized_keys, block_devices, carbon_black_info, carves,
##   chrome_extensions, cpu_time, cpuid, crontab, curl, curl_certificate, deb_packages, device_file, device_hash,
##   device_partitions, disk_encryption, dns_resolvers, docker_container_labels, docker_container_mounts,
##   docker_container_networks, docker_container_ports, docker_container_processes, docker_container_stats,
##   docker_containers, docker_image_labels, docker_images, docker_info, docker_network_labels, docker_networks,
##   docker_version, docker_volume_labels, docker_volumes, ec2_instance_metadata, ec2_instance_tags, etc_hosts,
##   etc_protocols, etc_services, file, file_events, firefox_addons, groups, hardware_events, hash, intel_me_info,
##   interface_addresses, interface_details, iptables, kernel_info, kernel_integrity, kernel_modules, known_hosts, last,
##   listening_ports, lldp_neighbors, load_average, logged_in_users, magic, md_devices, md_drives, md_personalities,
##   memory_devices, memory_info, memory_map, mounts, msr, npm_packages, opera_extensions, os_version, osquery_events,
##   osquery_extensions, osquery_flags, osquery_info, osquery_packs, osquery_registry, osquery_schedule, pci_devices,
##   platform_info, portage_keywords, portage_packages, portage_use, process_envs, process_events, process_file_events,
##   process_memory_map, process_open_files, process_open_sockets, processes, prometheus_metrics, python_packages, routes,
##   rpm_package_files, rpm_packages, shadow, shared_memory, shell_history, smbios_tables, socket_events, sudoers,
##   suid_bin, syslog_events, system_controls, system_info, time, uptime, usb_devices, user_events, user_groups,
##   user_ssh_keys, users, yara, yara_events, yum_sources</code></pre>
</div>
<div id="available-tables" class="section level3">
<h3 class="hasAnchor">
<a href="#available-tables" class="anchor"></a>available tables</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">osqdb</a></code></pre></div>
<pre><code>## src:  OsqueryConnection
## tbls: account_policy_data, acpi_tables, ad_config, alf, alf_exceptions, alf_explicit_auths, alf_services, app_schemes,
##   apps, apt_sources, arp_cache, asl, augeas, authorization_mechanisms, authorizations, authorized_keys, block_devices,
##   browser_plugins, carbon_black_info, carves, certificates, chrome_extensions, cpu_time, cpuid, crashes, crontab, curl,
##   curl_certificate, device_file, device_firmware, device_hash, device_partitions, disk_encryption, disk_events,
##   dns_resolvers, docker_container_labels, docker_container_mounts, docker_container_networks, docker_container_ports,
##   docker_container_processes, docker_container_stats, docker_containers, docker_image_labels, docker_images,
##   docker_info, docker_network_labels, docker_networks, docker_version, docker_volume_labels, docker_volumes, etc_hosts,
##   etc_protocols, etc_services, event_taps, extended_attributes, fan_speed_sensors, file, file_events, firefox_addons,
##   gatekeeper, gatekeeper_approved_apps, groups, hardware_events, hash, homebrew_packages, interface_addresses,
##   interface_details, iokit_devicetree, iokit_registry, kernel_extensions, kernel_info, kernel_panics, keychain_acls,
##   keychain_items, known_hosts, last, launchd, launchd_overrides, listening_ports, lldp_neighbors, load_average,
##   logged_in_users, magic, managed_policies, mounts, nfs_shares, nvram, opera_extensions, os_version, osquery_events,
##   osquery_extensions, osquery_flags, osquery_info, osquery_packs, osquery_registry, osquery_schedule, package_bom,
##   package_install_history, package_receipts, pci_devices, platform_info, plist, power_sensors, preferences,
##   process_envs, process_events, process_memory_map, process_open_files, process_open_sockets, processes,
##   prometheus_metrics, python_packages, quicklook_cache, routes, safari_extensions, sandboxes, shared_folders,
##   sharing_preferences, shell_history, signature, sip_config, smbios_tables, smc_keys, startup_items, sudoers, suid_bin,
##   system_controls, system_info, temperature_sensors, time, time_machine_backups, time_machine_destinations, uptime,
##   usb_devices, user_events, user_groups, user_interaction_events, user_ssh_keys, users, virtual_memory_info,
##   wifi_networks, wifi_status, wifi_survey, xprotect_entries, xprotect_meta, xprotect_reports, yara, yara_events,
##   yum_sources</code></pre>
</div>
<div id="sample-table" class="section level3">
<h3 class="hasAnchor">
<a href="#sample-table" class="anchor"></a>sample table</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">tbl</span>(osqdb, <span class="st">"dns_resolvers"</span>)</a></code></pre></div>
<pre><code>## # Source:   table&lt;dns_resolvers&gt; [?? x 5]
## # Database: OsqueryConnection
##   address id    netmask options type      
##   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     
## 1 9.9.9.9 0     32      1729    nameserver
## 2 1.1.1.1 1     32      1729    nameserver
## 3 rud.is  0     ""      1729    search</code></pre>
</div>
<div id="check-out-processes" class="section level3">
<h3 class="hasAnchor">
<a href="#check-out-processes" class="anchor"></a>check out processes</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">procs &lt;-<span class="st"> </span><span class="kw">tbl</span>(osqdb, <span class="st">"processes"</span>)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">filter</span>(procs, cmdline <span class="op">!=</span><span class="st"> ""</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(cmdline, total_size)</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 2]
## # Database: OsqueryConnection
##    cmdline                                                                                                   total_size
##    &lt;chr&gt;                                                                                                     &lt;chr&gt;     
##  1 /System/Library/CoreServices/loginwindow.app/Contents/MacOS/loginwindow console                           79962112  
##  2 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framework/Versions/A/Support/mdwor… 26521600  
##  3 /usr/sbin/cfprefsd agent                                                                                  8904704   
##  4 /usr/libexec/lsd                                                                                          27041792  
##  5 /usr/libexec/trustd --agent                                                                               39198720  
##  6 /usr/sbin/distnoted agent                                                                                 15196160  
##  7 /usr/libexec/secd                                                                                         26959872  
##  8 /usr/libexec/UserEventAgent (Aqua)                                                                        9367552   
##  9 /System/Library/Frameworks/CoreTelephony.framework/Support/CommCenter -L                                  9097216   
## 10 /usr/libexec/languageassetd --firstLogin                                                                  8486912   
## # ... with more rows</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">filter</span>(procs, name <span class="op">%like%</span><span class="st"> '%fire%'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">  </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: ??
## Variables: 26
## $ cmdline            &lt;chr&gt; "/Applications/FirefoxDeveloperEdition.app/Contents/MacOS/firefox -foreground"
## $ cwd                &lt;chr&gt; "/"
## $ disk_bytes_read    &lt;chr&gt; "54669312"
## $ disk_bytes_written &lt;chr&gt; "535171072"
## $ egid               &lt;chr&gt; "20"
## $ euid               &lt;chr&gt; "502"
## $ gid                &lt;chr&gt; "20"
## $ name               &lt;chr&gt; "firefox"
## $ nice               &lt;chr&gt; "0"
## $ on_disk            &lt;chr&gt; "1"
## $ parent             &lt;chr&gt; "1"
## $ path               &lt;chr&gt; "/Applications/FirefoxDeveloperEdition.app/Contents/MacOS/firefox"
## $ pgroup             &lt;chr&gt; "94889"
## $ pid                &lt;chr&gt; "94889"
## $ resident_size      &lt;chr&gt; "1031360512"
## $ root               &lt;chr&gt; ""
## $ sgid               &lt;chr&gt; "20"
## $ start_time         &lt;chr&gt; "1278843"
## $ state              &lt;chr&gt; "R"
## $ suid               &lt;chr&gt; "502"
## $ system_time        &lt;chr&gt; "64813"
## $ threads            &lt;chr&gt; "77"
## $ total_size         &lt;chr&gt; "762355712"
## $ uid                &lt;chr&gt; "502"
## $ user_time          &lt;chr&gt; "139677"
## $ wired_size         &lt;chr&gt; "0"</code></pre>
<p>see if any processes have no corresponding disk image</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">filter</span>(procs, on_disk <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(name, path, pid)</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 3]
## # Database: OsqueryConnection</code></pre>
<p>(gosh I hope ^^ was empty)</p>
<p>top 10 largest processes by resident memory size</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">arrange</span>(procs, <span class="kw">desc</span>(resident_size)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(pid, name, uid, resident_size)</a></code></pre></div>
<pre><code>## # Source:     lazy query [?? x 4]
## # Database:   OsqueryConnection
## # Ordered by: desc(resident_size)
##    name                  pid   resident_size uid  
##    &lt;chr&gt;                 &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;
##  1 java                  54764 4010483712    502  
##  2 com.docker.hyperkit   28543 2868359168    502  
##  3 rsession              21656 1592000512    502  
##  4 firefox               94889 1031344128    502  
##  5 QtWebEngineProcess    16108 943153152     502  
##  6 Adobe Desktop Service 1242  796278784     502  
##  7 kbfs                  13741 606306304     502  
##  8 Finder                1073  577482752     502  
##  9 recentsd              656   505774080     502  
## 10 plugin-container      94890 490287104     502  
## # ... with more rows</code></pre>
<p>process count for the top 10 most active processes</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">count</span>(procs, name, <span class="dt">sort=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## # Source:     lazy query [?? x 2]
## # Database:   OsqueryConnection
## # Ordered by: desc(n)
##    n     name                
##    &lt;chr&gt; &lt;chr&gt;               
##  1 17    MTLCompilerService  
##  2 14    mdworker            
##  3 9     bash                
##  4 8     iTerm2              
##  5 7     login               
##  6 6     Dropbox             
##  7 6     Google Chrome Helper
##  8 5     distnoted           
##  9 5     plugin-container    
## 10 5     ssh                 
## # ... with more rows</code></pre>
</div>
<div id="get-all-processes-listening-on-a-port-join-example" class="section level3">
<h3 class="hasAnchor">
<a href="#get-all-processes-listening-on-a-port-join-example" class="anchor"></a>get all processes listening on a port (join example)</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">listen &lt;-<span class="st"> </span><span class="kw">tbl</span>(osqdb, <span class="st">"listening_ports"</span>)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">left_join</span>(procs, listen, <span class="dt">by=</span><span class="st">"pid"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(port <span class="op">!=</span><span class="st"> ""</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="st">  </span><span class="kw">distinct</span>(name, port, address, pid)</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 4]
## # Database: OsqueryConnection
##    address   name                                         pid   port 
##    &lt;chr&gt;     &lt;chr&gt;                                        &lt;chr&gt; &lt;chr&gt;
##  1 127.0.0.1 2BUA8C4S2C.com.agilebits.onepassword4-helper 67094 6258 
##  2 ::1       2BUA8C4S2C.com.agilebits.onepassword4-helper 67094 6258 
##  3 127.0.0.1 2BUA8C4S2C.com.agilebits.onepassword4-helper 67094 6263 
##  4 ::1       2BUA8C4S2C.com.agilebits.onepassword4-helper 67094 6263 
##  5 ""        ARDAgent                                     494   0    
##  6 0.0.0.0   ARDAgent                                     494   3283 
##  7 ""        Adobe CEF Helper                             1234  0    
##  8 ""        Adobe CEF Helper                             1294  0    
##  9 ""        Adobe Desktop Service                        1242  0    
## 10 127.0.0.1 Adobe Desktop Service                        1242  15292
## # ... with more rows</code></pre>
</div>
<div id="get-file-info" class="section level3">
<h3 class="hasAnchor">
<a href="#get-file-info" class="anchor"></a>get file info</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">files &lt;-<span class="st"> </span><span class="kw">tbl</span>(osqdb, <span class="st">"file"</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">filter</span>(files, path <span class="op">==</span><span class="st"> "/etc/hosts"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(filename, size)</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 2]
## # Database: OsqueryConnection
##   filename size   
##   &lt;chr&gt;    &lt;chr&gt;  
## 1 hosts    1425159</code></pre>
</div>
<div id="users" class="section level3">
<h3 class="hasAnchor">
<a href="#users" class="anchor"></a>users</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">tbl</span>(osqdb, <span class="st">"users"</span>)</a></code></pre></div>
<pre><code>## # Source:   table&lt;users&gt; [?? x 10]
## # Database: OsqueryConnection
##    description           directory          gid   gid_signed shell          uid   uid_signed username     uuid         
##    &lt;chr&gt;                 &lt;chr&gt;              &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;        
##  1 AMaViS Daemon         /var/virusmails    83    83         /usr/bin/false 83    83         _amavisd     FFFFEEEE-DDD…
##  2 Analytics Daemon      /var/db/analyticsd 263   263        /usr/bin/false 263   263        _analyticsd  FFFFEEEE-DDD…
##  3 AppleEvents Daemon    /var/empty         55    55         /usr/bin/false 55    55         _appleevents FFFFEEEE-DDD…
##  4 applepay Account      /var/db/applepay   260   260        /usr/bin/false 260   260        _applepay    FFFFEEEE-DDD…
##  5 Application Owner     /var/empty         87    87         /usr/bin/false 87    87         _appowner    FFFFEEEE-DDD…
##  6 Application Server    /var/empty         79    79         /usr/bin/false 79    79         _appserver   FFFFEEEE-DDD…
##  7 Mac App Store Service /var/empty         33    33         /usr/bin/false 33    33         _appstore    FFFFEEEE-DDD…
##  8 Apple Remote Desktop  /var/empty         67    67         /usr/bin/false 67    67         _ard         FFFFEEEE-DDD…
##  9 Asset Cache Service   /var/empty         235   235        /usr/bin/false 235   235        _assetcache  FFFFEEEE-DDD…
## 10 Astris Services       /var/db/astris     245   245        /usr/bin/false 245   245        _astris      FFFFEEEE-DDD…
## # ... with more rows</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">tbl</span>(osqdb, <span class="st">"logged_in_users"</span>)</a></code></pre></div>
<pre><code>## # Source:   table&lt;logged_in_users&gt; [?? x 6]
## # Database: OsqueryConnection
##    host  pid   time       tty     type  user    
##    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   
##  1 ""    128   1526421243 console user  hrbrmstr
##  2 ""    16306 1527603827 ttys001 user  hrbrmstr
##  3 ""    18733 1527605466 ttys002 user  hrbrmstr
##  4 ""    18954 1527606102 ttys003 user  hrbrmstr
##  5 ""    21736 1527610627 ttys004 user  hrbrmstr
##  6 ""    23855 1527620471 ttys005 user  hrbrmstr
##  7 ""    23930 1527620785 ttys006 user  hrbrmstr
##  8 ""    72881 1527694548 ttys007 user  hrbrmstr
##  9 ""    29637 1527627647 ttys008 dead  hrbrmstr
## 10 ""    63892 1526725572 ttys009 dead  hrbrmstr
## # ... with more rows</code></pre>
</div>
<div id="groups" class="section level3">
<h3 class="hasAnchor">
<a href="#groups" class="anchor"></a>groups</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">tbl</span>(osqdb, <span class="st">"groups"</span>)</a></code></pre></div>
<pre><code>## # Source:   table&lt;groups&gt; [?? x 5]
## # Database: OsqueryConnection
##    gid   gid_signed groupname      
##    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;          
##  1 701   701        1              
##  2 83    83         _amavisd       
##  3 263   263        _analyticsd    
##  4 250   250        _analyticsusers
##  5 55    55         _appleevents   
##  6 260   260        _applepay      
##  7 87    87         _appowner      
##  8 81    81         _appserveradm  
##  9 79    79         _appserverusr  
## 10 33    33         _appstore      
## # ... with more rows</code></pre>
</div>
<div id="homebrew" class="section level3">
<h3 class="hasAnchor">
<a href="#homebrew" class="anchor"></a>homebrew!</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">tbl</span>(osqdb, <span class="st">"homebrew_packages"</span>)</a></code></pre></div>
<pre><code>## # Source:   table&lt;homebrew_packages&gt; [?? x 3]
## # Database: OsqueryConnection
##    name         path                            version  
##    &lt;chr&gt;        &lt;chr&gt;                           &lt;chr&gt;    
##  1 adns         /usr/local/Cellar/adns/         1.5.1    
##  2 alpine       /usr/local/Cellar/alpine/       2.21     
##  3 ant          /usr/local/Cellar/ant/          1.10.3   
##  4 apache-arrow /usr/local/Cellar/apache-arrow/ 0.9.0    
##  5 apache-arrow /usr/local/Cellar/apache-arrow/ 0.9.0_1  
##  6 aria2        /usr/local/Cellar/aria2/        1.33.1   
##  7 armadillo    /usr/local/Cellar/armadillo/    8.400.0  
##  8 armadillo    /usr/local/Cellar/armadillo/    8.400.1  
##  9 armadillo    /usr/local/Cellar/armadillo/    8.500.0_1
## 10 arpack       /usr/local/Cellar/arpack/       3.5.0_1  
## # ... with more rows</code></pre>
</div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that this project is released with a <a href="CONDUCT.html">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/hrbrmstr/osqueryr">https://​github.com/​hrbrmstr/​osqueryr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/hrbrmstr/osqueryr/issues">https://​github.com/​hrbrmstr/​osqueryr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Bob Rudis <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5670-2640" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" height="16"></a> </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bob Rudis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
